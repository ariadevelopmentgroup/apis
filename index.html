<!DOCTYPE html>
<html lang="hy">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>API & Webhook Հայտնաբերում</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f4f6f9;
      color: #333;
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
    }

    h1 {
      font-size: 2rem;
      color: #2c3e50;
    }

    .url-input-section {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 20px;
    }

    @media (min-width: 768px) {
      .url-input-section {
        flex-direction: row;
        align-items: center;
      }
    }

    input[type="text"] {
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      flex: 1;
    }

    button {
      padding: 12px 20px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #2980b9;
    }

    button:disabled {
      background-color: #95a5a6;
      cursor: not-allowed;
    }

    .security-status {
      margin: 15px 0;
      font-weight: bold;
    }

    .http {
      color: #e74c3c;
    }

    .https {
      color: #27ae60;
    }

    .scan-results {
      margin-top: 30px;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .result-item {
      margin: 15px 0;
      font-size: 16px;
    }

    .status {
      font-weight: bold;
      margin-left: 10px;
    }

    .success {
      color: #27ae60;
    }

    .failure {
      color: #e74c3c;
    }

    .links-list {
      margin: 10px 0 0 20px;
      font-size: 14px;
      color: #555;
    }

    .copy-btn {
      margin-left: 10px;
      padding: 5px 10px;
      font-size: 12px;
      background: #9b59b6;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .copy-btn:hover {
      background: #8e44ad;
    }

    .download-btn {
      margin-top: 20px;
      display: none;
    }

    .manual-suggestions {
      margin-top: 20px;
      padding: 15px;
      background: #f9f9f9;
      border-left: 4px solid #f39c12;
      font-size: 14px;
    }

    footer {
      text-align: center;
      margin-top: 50px;
      color: #7f8c8d;
      font-size: 14px;
    }

    .loader {
      display: none;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #3498db;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @media (max-width: 480px) {
      .container {
        padding: 10px;
      }
      h1 {
        font-size: 1.5rem;
      }
      input[type="text"], button {
        padding: 10px;
        font-size: 14px;
      }
      .result-item {
        font-size: 15px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>API & Webhook Հայտնաբերում</h1>
      <p>Մուտքագրեք կայքի URL-ը և սկանավորեք API-ներ և Webhook-եր</p>
    </header>

    <div class="url-input-section">
      <input type="text" id="websiteUrl" placeholder="Օրինակ՝ example.com" />
      <button id="scanBtn">Սկանավորել</button>
    </div>

    <div class="security-status" id="securityStatus"></div>

    <div class="loader" id="loader"></div>

    <div class="scan-results" id="results" style="display: none;">
      <h2>Սկանավորման արդյունքներ</h2>

      <div class="result-item">
        1. Private API: <span class="status" id="privateApi">⏳ սպասեք...</span>
        <div class="links-list" id="privateApiLinks"></div>
      </div>
      <div class="result-item">
        2. Public API: <span class="status" id="publicApi">⏳ սպասեք...</span>
        <div class="links-list" id="publicApiLinks"></div>
      </div>
      <div class="result-item">
        3. Partner API: <span class="status" id="partnerApi">⏳ սպասեք...</span>
        <div class="links-list" id="partnerApiLinks"></div>
      </div>
      <div class="result-item">
        4. RESTful API: <span class="status" id="restfulApi">⏳ սպասեք...</span>
        <div class="links-list" id="restfulApiLinks"></div>
      </div>
      <div class="result-item">
        5. SOAP API: <span class="status" id="soapApi">⏳ սպասեք...</span>
        <div class="links-list" id="soapApiLinks"></div>
      </div>
      <div class="result-item">
        6. GraphQL API: <span class="status" id="graphqlApi">⏳ սպասեք...</span>
        <div class="links-list" id="graphqlApiLinks"></div>
      </div>
      <div class="result-item">
        7. RPC API: <span class="status" id="rpcApi">⏳ սպասեք...</span>
        <div class="links-list" id="rpcApiLinks"></div>
      </div>
      <div class="result-item">
        8. Web API: <span class="status" id="webApi">⏳ սպասեք...</span>
        <div class="links-list" id="webApiLinks"></div>
      </div>
      <div class="result-item">
        9. Operating System API: <span class="status" id="osApi">⏳ սպասեք...</span>
        <div class="links-list" id="osApiLinks"></div>
      </div>
      <div class="result-item">
        10. Library API: <span class="status" id="libraryApi">⏳ սպասեք...</span>
        <div class="links-list" id="libraryApiLinks"></div>
      </div>

      <div class="result-item">
        Webhook-եր: <span class="status" id="webhooks">⏳ սպասեք...</span>
        <div class="links-list" id="webhookLinks"></div>
      </div>

      <button id="downloadBtn" class="download-btn">Ներբեռնել Արդյունքները</button>

      <div class="manual-suggestions" id="manualSuggestions" style="display: none;">
        <strong>Ուշադրություն:</strong> Հայտնաբերված չէ։ Խորհուրդ ենք տալիս ձեռքով ստուգել հետևյալ հնարավոր հղումները՝
        <ul>
          <li>/api</li>
          <li>/webhook</li>
          <li>/hooks</li>
          <li>/v1/api</li>
          <li>/graphql</li>
          <li>/rest</li>
        </ul>
      </div>
    </div>

    <footer>
      &copy; 2025 API & Webhook Scanner | Բոլոր իրավունքները պաշտպանված են
    </footer>
  </div>

  <script>
    const scanBtn = document.getElementById("scanBtn");
    const urlInput = document.getElementById("websiteUrl");
    const securityStatus = document.getElementById("securityStatus");
    const loader = document.getElementById("loader");
    const results = document.getElementById("results");
    const downloadBtn = document.getElementById("downloadBtn");
    const manualSuggestions = document.getElementById("manualSuggestions");

    // Կարգավորել արդյունքների դաշտերը
    const resultFields = {
      privateApi: { status: document.getElementById("privateApi"), links: document.getElementById("privateApiLinks") },
      publicApi: { status: document.getElementById("publicApi"), links: document.getElementById("publicApiLinks") },
      partnerApi: { status: document.getElementById("partnerApi"), links: document.getElementById("partnerApiLinks") },
      restfulApi: { status: document.getElementById("restfulApi"), links: document.getElementById("restfulApiLinks") },
      soapApi: { status: document.getElementById("soapApi"), links: document.getElementById("soapApiLinks") },
      graphqlApi: { status: document.getElementById("graphqlApi"), links: document.getElementById("graphqlApiLinks") },
      rpcApi: { status: document.getElementById("rpcApi"), links: document.getElementById("rpcApiLinks") },
      webApi: { status: document.getElementById("webApi"), links: document.getElementById("webApiLinks") },
      osApi: { status: document.getElementById("osApi"), links: document.getElementById("osApiLinks") },
      libraryApi: { status: document.getElementById("libraryApi"), links: document.getElementById("libraryApiLinks") },
      webhooks: { status: document.getElementById("webhooks"), links: document.getElementById("webhookLinks") },
    };

    // CORS Proxy (անվտանգ է միայն սկանավորման համար)
    const corsProxy = "https://api.allorigins.win/get?url=";

    // Հայտնի հղումներ
    const apiPaths = ["/api", "/api/v1", "/api/v2", "/rest", "/graphql", "/webhook", "/webhooks", "/hooks", "/rpc", "/soap", "/os-api", "/lib-api"];
    const detectedLinks = {
      apis: [],
      webhooks: []
    };

    scanBtn.addEventListener("click", async () => {
      const rawUrl = urlInput.value.trim();
      if (!rawUrl) {
        alert("Խնդրում ենք մուտքագրել կայքի URL-ը");
        return;
      }

      let domain = rawUrl;
      if (rawUrl.startsWith("http://")) {
        domain = rawUrl.replace("http://", "");
      } else if (rawUrl.startsWith("https://")) {
        domain = rawUrl.replace("https://", "");
      }

      let httpUrl = `http://${domain}`;
      let httpsUrl = `https://${domain}`;
      let fullUrl = "";

      // Ստուգել առաջինը HTTPS-ով
      try {
        await fetch(corsProxy + encodeURIComponent(httpsUrl), { method: "GET" });
        fullUrl = httpsUrl;
      } catch {
        try {
          await fetch(corsProxy + encodeURIComponent(httpUrl), { method: "GET" });
          fullUrl = httpUrl;
        } catch {
          alert("Չհաջողվեց կապվել կայքի հետ։ Ստուգեք URL-ը։");
          return;
        }
      }

      // Ցուցադրել անվտանգություն
      if (fullUrl.startsWith("https://")) {
        securityStatus.innerHTML = `Կայքը՝ <span class="https">https://</span> - Անվտանգ է`;
      } else {
        securityStatus.innerHTML = `Կայքը՝ <span class="http">http://</span> - Վտանգավոր է`;
      }

      // Լույսեր
      loader.style.display = "block";
      results.style.display = "block";
      downloadBtn.style.display = "none";
      manualSuggestions.style.display = "none";

      // Մաքրել նախորդ արդյունքները
      Object.keys(resultFields).forEach(key => {
        resultFields[key].status.textContent = "⏳ սկանավորվում է...";
        resultFields[key].status.className = "";
        resultFields[key].links.innerHTML = "";
      });
      detectedLinks.apis = [];
      detectedLinks.webhooks = [];

      // Սկանավորել հայտնի հղումները
      for (const path of apiPaths) {
        const testUrl = fullUrl + path;
        try {
          const response = await fetch(corsProxy + encodeURIComponent(testUrl));
          if (response.ok) {
            const data = await response.json();
            // Ստուգել, որ էջը գոյություն ունի
            if (data.contents && data.contents.length > 100) {
              if (path.includes("webhook") || path.includes("hooks")) {
                detectedLinks.webhooks.push(testUrl);
              } else {
                detectedLinks.apis.push(testUrl);
              }
            }
          }
        } catch (e) {
          // Անտեսել սխալները
        }
      }

      // Թարմացնել UI-ն
      setTimeout(() => {
        loader.style.display = "none";

        const hasApi = detectedLinks.apis.length > 0;
        const hasWebhook = detectedLinks.webhooks.length > 0;

        // Թարմացնել ամեն մի տեսակ
        Object.keys(resultFields).forEach(key => {
          const field = resultFields[key];
          if (key === "webhooks") {
            field.status.textContent = hasWebhook ? "✅ Առկա է" : "❌ Առկա չէ";
            field.status.className = hasWebhook ? "success" : "failure";
            if (hasWebhook) {
              detectedLinks.webhooks.forEach(url => {
                const div = document.createElement("div");
                div.textContent = url;
                const btn = document.createElement("button");
                btn.textContent = "Պատճենել";
                btn.className = "copy-btn";
                btn.onclick = () => navigator.clipboard.writeText(url).then(() => alert("Պատճենված է!"));
                div.appendChild(btn);
                field.links.appendChild(div);
              });
            }
          } else {
            field.status.textContent = hasApi ? "✅ Առկա է" : "❌ Առկա չէ";
            field.status.className = hasApi ? "success" : "failure";
            if (hasApi) {
              detectedLinks.apis.forEach(url => {
                const div = document.createElement("div");
                div.textContent = url;
                const btn = document.createElement("button");
                btn.textContent = "Պատճենել";
                btn.className = "copy-btn";
                btn.onclick = () => navigator.clipboard.writeText(url).then(() => alert("Պատճենված է!"));
                div.appendChild(btn);
                field.links.appendChild(div);
              });
            }
          }
        });

        // Ցուցադրել ներբեռնման կոճակը, եթե կա հայտնաբերում
        if (hasApi || hasWebhook) {
          downloadBtn.style.display = "block";
        } else {
          manualSuggestions.style.display = "block";
        }
      }, 1000);
    });

    // Ներբեռնել արդյունքները
    downloadBtn.addEventListener("click", () => {
      let content = "Webhook հղումներ\n";
      if (detectedLinks.webhooks.length > 0) {
        detectedLinks.webhooks.forEach((url, i) => {
          content += `${i+1}. ${url}\n`;
        });
      } else {
        content += "Ոչ մի հայտնաբերված Webhook\n";
      }

      content += "\nAPI Հղումներ\n";
      if (detectedLinks.apis.length > 0) {
        detectedLinks.apis.forEach((url, i) => {
          content += `${i+1}. ${url}\n`;
        });
      } else {
        content += "Ոչ մի հայտնաբերված API\n";
      }

      const blob = new Blob([content], { type: "text/plain" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "API_Webhook.txt";
      a.click();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>